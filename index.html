<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flipkart PLA Intelligence Engine</title>

  <!-- CSS -->
  <link rel="stylesheet" href="./css/reset.css" />
  <link rel="stylesheet" href="./css/variables.css" />
  <link rel="stylesheet" href="./css/layout.css" />
  <link rel="stylesheet" href="./css/components.css" />
</head>

<body>

  <!-- ================= HEADER ================= -->
  <header class="app-header">
    <div class="header-container">

      <!-- Left: Logo -->
      <div class="header-left">
        <img src="./assets/logo.png" alt="Logo" class="app-logo" />
      </div>

      <!-- Center: App Name -->
      <div class="header-center">
        <h1 class="app-title">
          Flipkart PLA Intelligence Engine
        </h1>
      </div>

      <!-- Right: Reserved -->
      <div class="header-right">
        <!-- Future: Export Button / Profile / Settings -->
      </div>

    </div>
  </header>


  <!-- ================= MAIN WRAPPER ================= -->
  <main class="main-wrapper">

    <!-- Summary Placeholder (Reserved for Future KPIs) -->
    <section class="summary-section">
      <div class="summary-placeholder">
        Summary Section (Reserved â€“ To Be Added Later)
      </div>
    </section>


    <!-- ================= REPORT TABS ================= -->
    <section class="reports-section">

      <div class="report-tabs">
        <button class="tab-btn active" data-tab="pla">
          PLA Recommendation
        </button>

        <button class="tab-btn" data-tab="stock">
          Stock Risk
        </button>

        <button class="tab-btn" data-tab="listing">
          Listing Issues
        </button>

        <button class="tab-btn" data-tab="scaling">
          Scaling Opportunities
        </button>
      </div>


      <!-- ================= REPORT CONTAINER ================= -->
      <div class="report-container">
        <div class="report-title">
          PLA Recommendation Report
        </div>

        <div class="report-content">
          <!-- JS will render table here -->
        </div>
      </div>

    </section>

  </main>


  <!-- ================= JS MODULE LOADER ================= -->
  <script type="module">
  import { CONFIG } from "./js/core/config.js";
  import { fetchCSV } from "./js/core/dataLoader.js";
  import { mergeData } from "./js/logic/decisionEngine.js";
  import { renderPLAReport } from "./js/reports/plaRecommendation.js";
  import { renderStockRisk } from "./js/reports/stockRisk.js";
  import { renderListingIssues } from "./js/reports/listingIssue.js";
  import { renderScalingOpportunities } from "./js/reports/scaling.js";

  let mergedData = [];

  async function init() {
    const traffic = await fetchCSV(CONFIG.TRAFFIC_URL);
    const sales = await fetchCSV(CONFIG.SALES_URL);

    mergedData = mergeData(traffic, sales);
    renderPLAReport(mergedData);
  }

  init();

  const tabs = document.querySelectorAll(".tab-btn");
  const reportTitle = document.querySelector(".report-title");

  const titles = {
    pla: "PLA Recommendation Report",
    stock: "Stock Risk Report",
    listing: "Listing Issue Report",
    scaling: "Scaling Opportunity Report"
  };

  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      tabs.forEach(t => t.classList.remove("active"));
      tab.classList.add("active");

      const type = tab.dataset.tab;
      reportTitle.textContent = titles[type];

      if (type === "pla") renderPLAReport(mergedData);
      if (type === "stock") renderStockRisk(mergedData);
      if (type === "listing") renderListingIssues(mergedData);
      if (type === "scaling") renderScalingOpportunities(mergedData);
    });
  });
</script>

</body>
</html>
